{
  "sourceUrl": "https://slack.engineering/feed/",
  "title": "Engineering at Slack",
  "description": "Hear directly from Slack's engineers about what we build, why and how we build it, and how you can use it.",
  "link": "https://slack.engineering",
  "items": [
    {
      "title": "Streamlining Security Investigations with Agents",
      "link": "https://slack.engineering/streamlining-security-investigations-with-agents/",
      "pubDate": "Mon, 01 Dec 2025 16:00:42 +0000",
      "isoDate": "2025-12-01T16:00:42.000Z",
      "creator": "Dominic Marks",
      "summary": "无法生成摘要（API请求失败）。",
      "shortSummary": "",
      "translated_title": "Streamlining Security Investigations with Agents",
      "images": [
        {
          "url": "https://slack.engineering/wp-content/uploads/sites/7/2025/11/investigation_round_simple_vertical_ad2b54.png?w=1020",
          "alt": "Flow diagram illustrating how agents cooperate during security investigations",
          "title": "",
          "position": 1
        },
        {
          "url": "https://slack.engineering/wp-content/uploads/sites/7/2025/11/knowledge_pyramid_retina.png?w=1020",
          "alt": "Pyramid diagram illustrating how investigation knowledge flows up from low to high cost models.",
          "title": "",
          "position": 2
        },
        {
          "url": "https://slack.engineering/wp-content/uploads/sites/7/2025/11/investigation_phases_vertical_final_300dpi.png?w=1020",
          "alt": "Flow diagram illustrating how the Director progresses the investigation through distinct phases.",
          "title": "",
          "position": 3
        },
        {
          "url": "https://slack.engineering/wp-content/uploads/sites/7/2025/11/process_ancestry_retina.png?w=1020",
          "alt": "Tree diagram illustrating how agents navigated the process tree.",
          "title": "",
          "position": 4
        }
      ],
      "contentSource": "RSS",
      "content": "Slack’s Security Engineering team is responsible for protecting Slack’s core infrastructure and services. Our security event ingestion pipeline handles billions of events per day from a diverse array of data sources. Reviewing alerts produced by our security detection system is our primary responsibility during on-call shifts. We’re going to show you how we’re using AI&#8230;"
    },
    {
      "title": "Android VPAT journey",
      "link": "https://slack.engineering/android-vpat-journey/",
      "pubDate": "Wed, 19 Nov 2025 18:00:39 +0000",
      "isoDate": "2025-11-19T18:00:39.000Z",
      "creator": "Hye Jung Choi",
      "summary": "无法生成摘要（API请求失败）。",
      "shortSummary": "",
      "translated_title": "Android VPAT journey",
      "images": [
        {
          "url": "https://slack.engineering/wp-content/uploads/sites/7/2025/05/image5.png?w=552",
          "alt": "Error is displayed right below an image edit field.",
          "title": "",
          "position": 1
        },
        {
          "url": "https://slack.engineering/wp-content/uploads/sites/7/2025/05/image4.png?w=640",
          "alt": "Error is shown via SKBanner error type.",
          "title": "",
          "position": 2
        },
        {
          "url": "https://slack.engineering/wp-content/uploads/sites/7/2025/05/image3.png?w=341",
          "alt": "Previously, there is no visual indictor in a search input field other than a placeholder text. When a user enters a text, it's not obvious what this field is.",
          "title": "",
          "position": 3
        },
        {
          "url": "https://slack.engineering/wp-content/uploads/sites/7/2025/05/image2.png?w=374",
          "alt": "We added a magnifying glass icon to the input field. When a user enters a text, it's clear that the edit field is for search.",
          "title": "",
          "position": 4
        },
        {
          "url": "https://slack.engineering/wp-content/uploads/sites/7/2025/05/image7.png?w=640",
          "alt": "Before: there is no indication from UI that each workspace is draggable to move around.",
          "title": "",
          "position": 5
        },
        {
          "url": "https://slack.engineering/wp-content/uploads/sites/7/2025/05/image1.png?w=640",
          "alt": "After: Upon entering Edit mode, each row in the workspace is equipped with a six-dot drag handle. Once the user has completed rearranging the workspaces, they can click the \"Done\" button located in the top right corner, causing the six-dot drag handles to disappear.",
          "title": "",
          "position": 6
        },
        {
          "url": "https://slack.engineering/wp-content/uploads/sites/7/2025/05/image8.png?w=395",
          "alt": "Error text with red color is shown below an edit field.",
          "title": "",
          "position": 7
        },
        {
          "url": "https://slack.engineering/wp-content/uploads/sites/7/2025/05/image6.png?w=395",
          "alt": "Error text with red color and an error icon are shown below an edit field.",
          "title": "",
          "position": 8
        }
      ],
      "contentSource": "RSS",
      "content": "Background A Voluntary Product Accessibility Template (VPAT) is a document that outlines how well a product aligns with accessibility (a11y) standards. Its primary purpose is to inform customers about a product&#8217;s a11y features, enabling them to make informed decisions before purchasing software. At Slack, we conducted a VPAT by a third party a11y vendor in&#8230;"
    },
    {
      "title": "构建更好的软件以更好地构建软件 (原标题: Build better software to build software better)",
      "link": "https://slack.engineering/build-better-software-to-build-software-better/",
      "pubDate": "Thu, 06 Nov 2025 16:00:47 +0000",
      "isoDate": "2025-11-06T16:00:47.000Z",
      "creator": "David Reed (he/his)",
      "summary": "# 通过构建更好的软件来更好地构建软件：优化Quip和Slack Canvas的构建流程\n\n本文介绍了Quip和Slack Canvas团队如何通过结合现代高性能构建工具（Bazel）和经典软件工程原则，解决其后端构建耗时60分钟的重大问题，旨在帮助工程师更快地交付更好的代码。\n\n## 构建性能的核心原则\n\n文章首先从软件代码性能的角度出发，阐述了两个核心优化策略，并将其类比到构建系统：\n\n*   **减少工作量（缓存）**\n    *   **原理**：存储昂贵工作的成果，避免重复计算，以内存换时间。\n    *   **要求**：被缓存的函数或工作单元必须是**封闭的（hermetic）**（只使用明确给定的输入产生输出）和**幂等的（idempotent）**（相同输入总是产生相同输出）。\n    *   **粒度**：缓存键的粒度至关重要。将缓存应用于更小的、更精细的工作单元（例如，处理单张图片而非图片列表），可以显著提高缓存命中率和整体性能。\n*   **分担负载（并行化）**\n    *   **原理**：将工作分散到多个计算资源上并行执行，以计算资源换时间。\n    *   **要求**：\n        *   严格完整地定义并行工作的输入和输出。\n        *   能够跨边界（线程、进程、网络）移动输入和输出。\n        *   代码必须管理工作单元可能以任何顺序完成或失败的情况。\n    *   **粒度**：工作单元的粒度影响并行化的效率，需要根据具体问题权衡任务大小和数量。\n\n## 将原则应用于构建系统（Bazel）\n\nBazel构建系统将这些软件工程原则内化：\n\n*   **构建目标**：在Bazel中，构建目标形成一个有向无环图（DAG），每个目标包含：\n    *   作为依赖项或输入的源文件（`srcs`）。\n    *   作为构建步骤输出的文件（`outs`）。\n    *   将输入转换为输出的命令（`cmd`）。\n*   **封闭性和幂等性**：Bazel在沙盒中执行构建，确保命令只能访问声明的输入文件，从而实现封闭性。同时，要求构建步骤的命令是幂等和封闭的。\n*   **Bazel的优势**：\n    *   **自动缓存**：当目标的输入未改变时，自动使用缓存的输出。\n    *   **分布式构建**：将构建操作分发到多个CPU核心甚至构建集群中的多台机器。\n    *   **最小化工作**：只执行生成所需输出工件所需的最小工作量。\n*   **实现Bazel魔力的关键**：一个定义良好、由幂等、封闭且粒度适中的构建单元组成的依赖图。\n\n## Quip和Canvas面临的挑战\n\n尽管Bazel强大，但Quip和Canvas的实际构建系统远比简单示例复杂，存在以下关键缺陷，导致无法直接从Bazel获益：\n\n*   **依赖图混乱**：图未定义好，甚至包含循环依赖。\n*   **工作单元问题**：构建执行单元庞大，并非所有都幂等，且许多构建步骤会修改工作目录，导致封闭性难以实现。\n*   **缓存命中率低**：构建系统高度互联，导致缓存命中率为零。例如，一个“函数”有100个参数，其中2-3个总是变化，使得缓存失效。\n\n## 根本原因：缺乏关注点分离\n\n团队发现构建性能问题并非孤立的构建系统问题，而是应用程序中普遍缺乏关注点分离的症状：\n\n*   **代码与构建深度耦合**：后端代码和构建代码深度交织，应用内部框架协调构建步骤。\n*   **跨语言基础设施耦合**：Python业务逻辑处理Protobuf编译、Python和Cython工件，同时Python脚本还协调TypeScript和Less的转换。\n*   **关键依赖**：前端构建依赖于**整个已构建的Python后端**。这意味着不仅TypeScript的改变，**每一个Python的改变**都会导致前端的缓存键失效，从而触发昂贵的完整重建（平均每次构建增加35分钟，占总耗时一半以上）。\n*   **负面影响**：\n    *   工程师难以推断代码修改的影响范围，因为后端修改可能同时影响前端或构建系统。\n    *   由于构建耗时过长，无法在拉取请求（PR）级别提供早期预警。\n    *   缺乏健康信号和难以推理后果导致构建和主分支频繁中断。\n\n## 解决方案：彻底分离与重构\n\n为了解决这些问题，团队进行了以下工程工作：\n\n*   **彻底解耦**：明确切断前端与后端、Python与TypeScript、应用程序与构建系统之间的依赖。\n*   **Starlark重写**：将Python构建编排代码重写为Starlark（Bazel用于构建定义的语言），Starlark的约束特性有助于强制实现与应用代码的完全分离。\n*   **精简Python脚本**：重写现有Python脚本，移除所有非Python标准库的依赖，并移除并行化代码（由Bazel处理）。\n*   **验证工具**：开发了一个Rust工具，用于比较旧流程和新代码生成的工件，以确保行为一致性并指导逻辑修正，从而建立工程师对新系统的信心。\n\n通过这些努力，团队旨在实现一个定义良好、高效且可维护的构建系统，从而显著提升软件交付速度和质量。",
      "shortSummary": "Quip和Slack Canvas团队通过引入Bazel并应用缓存与并行化等软件工程原则，解决了后端构建耗时60分钟的问题。核心挑战在于后端代码与构建系统深度耦合，前端构建依赖于整个Python后端，导致缓存命中率为零。团队通过彻底分离前端与后端、Python与TypeScript的依赖，将构建逻辑重写为Starlark，并开发验证工具，最终实现了构建流程的显著加速和稳定性提升。",
      "translated_title": "构建更好的软件以更好地构建软件",
      "images": [],
      "contentSource": "RSS",
      "content": "We manage the build pipeline that delivers Quip and Slack Canvas’s backend. A year ago, we were chasing exciting ideas to help engineers ship better code, faster. But we had one huge problem: builds took 60 minutes. With a build that slow, the whole pipeline gets less agile, and feedback doesn’t come to engineers until&#8230;"
    },
    {
      "title": "改进我们的Chef基础设施：安全而不中断 (原标题: Advancing Our Chef Infrastructure: Safety Without Disruption)",
      "link": "https://slack.engineering/advancing-our-chef-infrastructure-safety-without-disruption/",
      "pubDate": "Thu, 23 Oct 2025 18:17:56 +0000",
      "isoDate": "2025-10-23T18:17:56.000Z",
      "creator": "Archie Gunasekara",
      "summary": "## 改进Chef基础设施：安全而不中断\n\n这篇文章是Slack关于其Chef基础设施演进的续篇，重点介绍了如何在不中断现有食谱或角色（cookbooks or roles）的情况下，提升Chef部署的安全性和可靠性。面对将Chef Policyfiles引入可能带来的短期风险，Slack选择了一条改进现有EC2框架的路径。\n\n### 挑战：单一生产环境的风险\n\n此前，每个实例都通过定时任务（cron job）定期触发Chef运行，主要用于合规性，确保配置一致。虽然这些任务在可用区（Availability Zones）之间错开，以避免同时影响所有节点，但单一共享的生产环境存在一个关键限制：新配置的节点会立即获取最新的（可能存在问题的）变更。在大规模扩容事件中，这可能导致数十或数百个节点以损坏的配置启动，构成严重的可靠性风险。\n\n### 解决方案一：拆分Chef环境\n\n为了解决上述问题，Slack将单一的生产Chef环境拆分为多个独立的桶，例如 `prod-1` 到 `prod-6`。服务团队仍然将实例启动为“prod”，但系统会在后台根据实例的可用区ID将其映射到这些更具体的环境中。\n\n*   **实现方式**：\n    *   Slack的基础AMI（Amazon Machine Image）中包含一个名为 **Poptart Bootstrap** 的工具。该工具在实例启动时通过 `cloud-init` 运行。\n    *   Poptart Bootstrap 被扩展，以检查节点的可用区ID，并将其分配到相应的编号生产Chef环境（`prod-1` 到 `prod-6`）。\n*   **优势**：\n    *   新节点不再从一个全局的真理源拉取配置，而是均匀分布在隔离的环境中，增加了额外的安全性和弹性。\n    *   对单个环境的变更现在只影响特定可用区中的节点，显著降低了部署期间的风险和影响范围。\n\n![环境流程图](https://slack.engineering/wp-content/uploads/sites/7/2025/10/env_flow.png?w=438)\n\n### 发布列车模型\n\n为了管理跨多个Chef环境的变更推广，Slack采用了发布列车模型：\n\n*   **推广流程**：最新的食谱变更会在整点推广到沙盒（sandbox）环境，然后是开发（dev）环境，最后从半点开始推广到生产环境。\n*   **金丝雀环境（Canary Environment）**：`prod-1` 被视为金丝雀生产环境，每小时接收更新（假设有新的食谱变更合并），以确保变更在真实的生产环境中得到定期验证，从而在早期以更小、更安全的方式捕获生产影响问题。\n*   **分阶段发布（Staggered Rollout）**：对于 `prod-2` 到 `prod-6`，采用分阶段发布模型。在将新版本部署到 `prod-2` 之前，系统会确保前一个版本已成功推广到所有生产环境，直至 `prod-6`。这种错开的发布方式最大限度地减少了影响范围，并提供了在发布列车早期捕获回归的机会。\n*   **示例**：文章详细展示了不同版本（A、B、C、D、E、F）如何在沙盒、开发和生产环境（prod-1到prod-6）中逐步推广，说明了变更需要更长时间才能完全部署到所有生产节点，但这种延迟为跨不同可用区部署之间提供了宝贵的时间，以便在问题变更完全传播之前捕获并解决任何问题。\n\n### 解决方案二：基于信号的Chef触发机制\n\n由于现在多个生产Chef环境在不同时间接收更新，固定计划的定时任务不再实用。因此，Slack从计划运行转向构建了一个新的服务，根据信号触发节点上的Chef运行。\n\n*   **Chef Librarian增强**：\n    *   Chef Librarian 服务负责监控新的Chef食谱制品并将其上传到所有Chef堆栈。\n    *   它现在被增强，每当将某个版本的制品推广到特定环境时，就会向一个S3桶发送消息。\n*   **S3结构**：S3桶中的 `chef-run-triggers` 键下维护一个嵌套结构，其中每个键代表一个Chef堆栈，再往下是每个环境名称的键。每个环境键都包含一个JSON对象，其中包含清单（manifest）详细信息，如版本、时间戳、食谱版本等。\n*   **Chef Summoner 服务**：\n    *   这是一个运行在Slack每个节点上的服务。\n    *   它负责检查与节点Chef堆栈和环境对应的S3键。\n    *   如果Chef Librarian发出的信号中存在新版本，Summoner会读取配置的 `Splay` 值并相应地安排Chef运行。\n    *   **Splay**：用于错开Chef运行，避免给定环境和堆栈中的所有节点同时尝试运行Chef，从而避免负载峰值和资源争用。\n    *   **合规性回退**：即使没有新的信号，Chef Summoner 也会确保Chef至少每12小时运行一次，以保持合规性并确保节点保持其预期的配置状态。\n\n![Summoner Logo](https://slack.engineering/wp-content/uploads/sites/7/2025/10/summoner_logo.png?w=640)\n\n### 结论\n\n通过引入拆分的生产环境和基于信号的Chef触发机制，Slack成功避免了新节点立即拉取错误配置的问题。现在，每个节点都与其可用区环境绑定，变更逐步推出。这种设置大大增强了弹性，消除了单点故障，并构建了保障措施，使整个系统更安全、更可预测。",
      "shortSummary": "Slack改进了其Chef基础设施，旨在实现更安全、更可靠的部署，同时避免中断。核心改进包括：将单一生产环境拆分为多个基于可用区的独立环境（如prod-1到prod-6），通过金丝雀发布和发布列车模型逐步推广变更，从而显著缩小了风险范围。同时，将Chef运行触发机制从固定计划改为基于信号的“Chef Summoner”服务，该服务根据Chef Librarian在S3中发出的更新信号来调度Chef运行，并包含12小时的合规性回退机制。这些措施共同提升了系统的弹性和可预测性。",
      "translated_title": "改进我们的Chef基础设施：安全而不中断",
      "images": [
        {
          "url": "https://slack.engineering/wp-content/uploads/sites/7/2025/10/env_flow.png?w=438",
          "alt": "",
          "title": "",
          "position": 1
        },
        {
          "url": "https://slack.engineering/wp-content/uploads/sites/7/2025/10/summoner_logo.png?w=640",
          "alt": "",
          "title": "",
          "position": 2
        },
        {
          "url": "https://slack.engineering/wp-content/uploads/sites/7/2025/10/summoner_flow.png?w=630",
          "alt": "",
          "title": "",
          "position": 3
        }
      ],
      "contentSource": "完整文章",
      "content": "Last year, I wrote a blog post titled Advancing Our Chef Infrastructure, where we explored the evolution of our Chef infrastructure over the years. We talked about the shift from a single Chef stack to a multi-stack model, and the challenges that came with it &#8211; from updating how we handle cookbook uploads to navigating&#8230;"
    },
    {
      "title": "部署安全：减少变更对客户的影响 (原标题: Deploy Safety: Reducing customer impact from change)",
      "link": "https://slack.engineering/deploy-safety/",
      "pubDate": "Tue, 07 Oct 2025 16:33:12 +0000",
      "isoDate": "2025-10-07T16:33:12.000Z",
      "creator": "Sam Bailey",
      "summary": "### 部署安全计划：减少变更对客户的影响\n\nSlack在2023年中启动了“部署安全计划”，旨在显著提升可靠性并减少因内部变更（特别是代码部署）对客户造成的影响。目标是到2025年1月，将客户影响时长从峰值减少90%，并持续下降。\n\n#### 问题定义\n\n随着业务发展，系统需求不断变化，导致以下关键问题：\n\n*   **关键性增加**：Slack对客户变得越来越关键，客户对产品整体及特定功能的可靠性期望提高。\n*   **变更触发事件**：73%的客户事件由Slack内部变更（主要是代码部署）触发。\n*   **广泛影响**：变更触发的事件发生在各种系统和部署流程中。\n*   **客户反馈**：中断超过10分钟会变得更具破坏性。\n*   **旧方法缺陷**：过去专注于单个部署系统，导致手动变更流程拖慢创新速度，降低工程士气，并阻碍业务目标实现。\n\n#### “北极星”目标与部署安全宣言\n\n为解决这些问题，Slack设定了初始的“北极星”目标，适用于最高重要性服务的所有部署方法：\n\n*   **减少部署影响时间**：在10分钟内实现自动检测与修复，20分钟内实现手动检测与修复。\n*   **降低影响严重性**：在影响10%的集群之前检测到问题部署。\n*   **保持Slack的开发速度**。\n\n这些目标随后演变为“部署安全宣言”，适用于Slack所有部署系统和流程，鼓励实施自动化系统改进、安全防护措施和文化变革。\n\n#### 衡量指标\n\n为了衡量计划成效，Slack需要一个能合理（尽管不完美）反映客户对Slack可靠性体验的指标：\n\n*   **部署安全指标**：由高严重性及选定中等严重性变更触发事件导致的客户影响小时数。\n*   **“选定”中等严重性**：根据实际客户影响程度进行筛选，因为内部严重性级别可能不完全反映最终客户影响。\n*   **指标设计标准**：衡量结果、理解测量内容（真实与模拟）、测量一致性，并持续通过与客户的直接对话验证其与客户感受的匹配度。\n\n#### 投资策略与项目示例\n\n由于事件数据具有滞后性，且客户正面临痛点，Slack采取了以下投资策略：\n\n*   初期广泛投资，偏向行动。\n*   首先关注已知痛点领域。\n*   根据结果进一步投资成功项目或模式。\n*   削减对影响力最小领域的投资。\n*   设定灵活的短期路线图，可根据结果调整。\n\n项目投资方向旨在影响以下一个或多个方面：\n\n*   在部署流程早期检测问题。\n*   改进自动修复时间。\n*   改进手动修复时间。\n*   通过设计隔离边界（爆炸半径控制）降低问题严重性。\n\n**Webapp后端部署示例流程**：\n\n1.  投入一个季度进行自动指标监控的工程工作。\n2.  再投入一个季度，通过自动告警和手动回滚操作确认客户影响对齐。\n3.  投资自动部署和回滚，通过多次自动回滚成功将客户影响控制在10分钟以下。\n4.  进一步投资监控更多指标并优化手动回滚。\n5.  投资手动前端回滚能力。\n6.  将进一步投资对齐到Slack的集中部署编排系统，以统一指标驱动部署与自动修复到更多部署系统。\n\n**成果**：Webapp后端、前端及部分基础设施部署现在显著更安全，并持续季度性改进。这种“尝试-成功-迭代-复制”的模式被证明非常有效。值得注意的是，未达到预期影响的项目并非失败，而是指导投资和理解价值的关键输入。\n\n#### 结果\n\n尽管进展是非线性的，且使用滞后指标存在挑战，但计划取得了显著成果：\n\n*   在第一季度的工作后（主要通过与工程团队沟通），已观察到初步改善。\n*   在项目开始交付变更后，2024年2月至4月期间出现了影响峰值（但如果没有早期工作，峰值会更高）。\n*   引入自动回滚后，结果显著改善。\n*   观察每个项目的完整影响通常有3-6个月的滞后时间。\n*   目标数字持续调整，2025年目标再次降低，重点是通过部署系统一致性来缓解不频繁的客户影响峰值。\n\n#### 经验教训\n\n该计划需要持续学习和迭代，并从中吸取了许多重要经验：\n\n*   **确保优先级和对齐**：定期高管审查、在公司/工程目标中设定高优先级，以及高管层的坚定支持至关重要。\n*   **对滞后指标保持耐心和信心**：由于结果测量有数月延迟，需要耐心。同时，收集中间指标（如问题检测）以确认改进正在发挥作用，并相信基于现有信息做出的决策，同时保持根据结果调整路径的敏捷性。\n*   **人们会延迟采用新实践**：需要提供直接培训（必要时多次），持续改进手动回滚工具，并鼓励频繁使用工具以建立熟练度、信心和舒适度。\n*   **直接接触工程团队至关重要**：部署安全团队直接与各团队沟通，理解其系统和流程，提供改进指导，并鼓励创新和优先级排序。\n*   **保持核心指标尽可能一致**：选择一个指标，保持一致性，并根据结果验证进行调整，避免在选择“最佳”指标上浪费时间。\n*   **与工程人员保持一致、直接的沟通**：管理层对优先级和结果理解良好，但普通工程师可能不清楚，这揭示了改进沟通对齐的机会。\n\n#### 未来展望\n\nSlack将持续投资部署安全，因为可靠性是Salesforce和Slack信任价值的核心组成部分。未来的改进方向包括：\n\n*   持续改进基于自动指标的部署和修复，以保持积极趋势。\n*   提高Slack所有部署中部署安全流程的一致性，以缓解意外或不频繁的客户影响峰值。\n*   将计划范围扩展到将剩余手动部署流程迁移到基于代码的部署。\n\n正在进行的项目示例包括：集中部署编排工具扩展到其他基础设施部署模式、前端自动回滚、指标质量改进、AI指标异常检测，以及AI生成预生产测试的进一步推广。",
      "shortSummary": "Slack于2023年中启动“部署安全计划”，旨在通过改进部署流程和提升安全文化，将因内部变更（特别是代码部署）导致的客户影响时长到2025年减少90%。该计划通过设定“北极星”目标、引入客户影响小时数作为核心指标、灵活的投资策略以及自动化检测与修复，取得了显著成效。关键经验包括高管对齐、对滞后指标的耐心、直接团队沟通和持续改进。未来将继续投资自动化和流程一致性。",
      "translated_title": "部署安全：减少变更对客户的影响",
      "images": [],
      "contentSource": "RSS",
      "content": "It’s mid 2023 and we’ve identified some opportunities to improve our reliability. Fast forward to January 2025. Customer impact hours are reduced from the peak by 90% and continuing to trend downward. We’re a year and half into the Deploy Safety Program at Slack, improving the way we deploy, uplifting our safety culture and continuing&#8230;"
    },
    {
      "title": "构建 Slack 的异常事件响应 (原标题: Building Slack’s Anomaly Event Response)",
      "link": "https://slack.engineering/building-slacks-anomaly-event-response/",
      "pubDate": "Thu, 04 Sep 2025 10:00:02 +0000",
      "isoDate": "2025-09-04T10:00:02.000Z",
      "creator": "Nathan Lehotsky",
      "summary": "## 构建 Slack 的异常事件响应 (AER)\n\n### 引言：应对网络安全挑战\n\n随着网络攻击日益复杂和迅速，检测到响应的时间差变得至关重要。传统的被动安全方法让攻击者占据优势，迫使安全团队专注于损害评估而非主动预防。为解决这一挑战，Slack 开发了 **异常事件响应 (AER)**，这是一种新的主动防御机制。AER 结合实时监控和高级分析，能够自主识别平台上出现的高置信度威胁行为。当检测到可疑活动时，系统会自动终止相关用户会话，将安全检测和响应时间从数天/小时缩短到几分钟。这使得 AER 成为一种强大的原生安全能力，能够在攻击链完全执行之前中断它们，从而防止数据泄露和系统入侵，而无需额外的安全工具或人力。\n\n### 保护 Slack 的共同责任\n\nSlack 是数千万用户每周进行工作沟通和协作的中心，每天产生数十亿次交互。为了确保客户安全，Slack 为企业客户提供全面的审计日志，并进一步提供**异常审计日志**，利用高级分析标记工作区中的异常活动，如不规则登录、上传恶意软件或意外数据传输。虽然这些日志是早期预警系统，但它们仍需要安全人员审查或与第三方解决方案集成才能转化为可操作的洞察。AER 旨在弥合这一差距，提供一个开箱即用的自动化解决方案，任何企业网格客户都可以单独使用或作为其更广泛安全策略的一部分。Slack 坚信安全是平台与客户之间的共同责任，AER 赋能客户，同时平台也积极中和威胁。\n\n### 设计理念\n\n在设计 AER 时，Slack 专注于支持平台面临的最常见威胁类型，优先考虑具有广泛适用性的检测。AER 旨在识别以下类型的异常行为：\n\n*   从 Tor 出口节点访问 Slack\n*   过度下载（潜在的数据泄露指标）\n*   通过非 Slack 原生自动化工具进行数据抓取\n*   会话指纹不匹配\n*   异常 API 调用量和模式\n*   异常用户代理（指示从非标准或虚拟客户端访问）\n\n考虑到每个客户的使用方式和风险状况不同，AER 被设计为可配置的，允许组织选择哪些检测是重要的，哪些应仅记录而不采取响应行动。这种可配置性也延伸到通知偏好设置。用户可以通过“工具和设置”→“组织设置”→“安全”→“安全设置”导航到“异常事件响应设置”部分进行配置。\n\n![A modal window titled \"Anomaly event response\" with various checkboxes for detecting anomaly events like \"Accessing Slack from a Tor exit node\" and \"Data scraping,\" and for sending notifications to \"Org Primary Owner\" and \"Security Admins\" via email and Slack.](https://slack.engineering/wp-content/uploads/sites/7/2025/06/Settings-Modal.png?w=1020)\n\n### 系统架构与技术深入\n\nAER 采用多层架构，专为实时异常检测、异步作业编排和动态通知而设计。其核心由三个组件构成：\n\n![A flowchart illustrating an \"Automated Event Response\" process. It starts with \"Suspicious User Activity,\" followed by \"Activity Analyzed,\" then \"Anomaly Detected.\" This leads to \"AER Controller,\" which determines if it's a \"Supported Anomaly.\" If so, \"User Sessions Terminated\" occurs. From \"User Sessions Terminated,\" two paths emerge: \"Audit Logged\" (which is \"Always\" done) and \"Customer Notified\" (which is \"Configurable\").](https://slack.engineering/wp-content/uploads/sites/7/2025/06/aer-simple-diagram.png?w=1020)\n\n1.  **检测引擎：**\n    *   大规模监控 Slack 事件（每天数十亿次）。\n    *   结合基于规则的启发式方法和动态阈值，这些阈值根据每个企业的历史使用模式进行校准。\n    *   这种自适应方法显著减少了误报，并允许持续微调检测灵敏度。\n\n2.  **决策框架：**\n    *   评估识别出可疑行为时创建的每个审计负载。\n    *   根据客户的 AER 配置和内部规则执行验证检查。\n    *   分析会话以确定恶意行为是否在用户会话终止后持续存在，同时保护合法用户免受连续终止循环。\n    *   一旦异常被验证且客户已启用该事件类型的检测，就会将异步作业排队以执行自主响应。\n\n3.  **响应编排：**\n    *   终止属于行为用户的所有活动会话。\n    *   生成 `user_sessions_reset_by_anomaly_event_response` 审计日志，其中包含触发响应的异常类型、行为用户上下文和会话 ID，以便进行调查。\n    *   根据客户的通知偏好路由额外通知。行为用户始终收到会话终止的电子邮件通知。\n    *   客户可配置将通知发送给组织主要所有者和安全管理员。\n    *   内置智能通知逻辑，可识别组织中身兼多职的人员，避免重复通知。\n    *   通知方式包括电子邮件和 Slack 安全机器人（通过私信）。\n\n![A Slack notification from \"Slack Security\" stating that \"@Matt Brewer has been signed out of all their active sessions in response to a potentially suspicious anomaly event: unexpected_scraping. It provides links to view details in audit logs and learn more.\"](https://slack.engineering/wp-content/uploads/sites/7/2025/06/Screenshot-2025-03-25-at-12.10.25%E2%80%AFPM.png?w=1020)\n\n### 主要发现与影响\n\n自 2025 年 2 月推出以来，AER 的自动化干预已验证了主动安全措施的重要性，并证明了其在实时中断可疑活动方面的有效性。根据 IBM 的报告，2024 年数据泄露的平均成本达到 488 万美元，云协作平台的平均事件响应时间为 277 天。AER 能够将这一响应窗口显著缩短，从而对安全产生重大影响。通过自动终止从事异常活动的用户会话，AER 可以防止可能未被发现的潜在安全事件。这为企业客户带来了增强的数据保护，同时降低了安全团队的开销。AER 提供了一种可扩展、自适应的防御机制，确保 Slack 仍然是一个安全可靠的协作平台。\n\n### 结论\n\nAER 通过弥合检测与响应之间的差距，中和了传统上对攻击者有利的延迟。AER 所体现的共同责任模型代表了企业安全的未来，即平台提供商和客户共同努力创建多层防御。通过提供开箱即用的高级安全，同时为具有复杂安全运营的组织提供定制化选项，AER 确保所有客户都能从实时威胁中断中受益，无论其规模或安全资源如何。Slack 致力于持续完善 AER 的检测机制、扩展响应能力并整合客户反馈，以提供持续发展、默默而有效地工作的安全解决方案。",
      "shortSummary": "Slack 推出了异常事件响应 (AER) 系统，旨在通过实时监控和高级分析，自动检测并响应平台上的高置信度威胁行为。当检测到可疑活动时，AER 会自动终止相关用户会话，将安全检测和响应时间从数天/小时缩短到几分钟。这有效中断攻击链，防止数据泄露和系统入侵，从而增强企业数据保护并降低安全开销。AER 是可配置的，支持平台与客户共同承担安全责任的模型。",
      "translated_title": "构建 Slack 的异常事件响应",
      "images": [
        {
          "url": "https://slack.engineering/wp-content/uploads/sites/7/2025/06/Settings-Modal.png?w=1020",
          "alt": "A modal window titled \"Anomaly event response\" with various checkboxes for detecting anomaly events like \"Accessing Slack from a Tor exit node\" and \"Data scraping,\" and for sending notifications to \"Org Primary Owner\" and \"Security Admins\" via email and Slack.",
          "title": "",
          "position": 1
        },
        {
          "url": "https://slack.engineering/wp-content/uploads/sites/7/2025/06/aer-simple-diagram.png?w=1020",
          "alt": "A flowchart illustrating an \"Automated Event Response\" process. It starts with \"Suspicious User Activity,\" followed by \"Activity Analyzed,\" then \"Anomaly Detected.\" This leads to \"AER Controller,\" which determines if it's a \"Supported Anomaly.\" If so, \"User Sessions Terminated\" occurs. From \"User Sessions Terminated,\" two paths emerge: \"Audit Logged\" (which is \"Always\" done) and \"Customer Notified\" (which is \"Configurable\").",
          "title": "",
          "position": 2
        },
        {
          "url": "https://slack.engineering/wp-content/uploads/sites/7/2025/06/Screenshot-2025-03-25-at-12.10.25%E2%80%AFPM.png?w=1020",
          "alt": "A Slack notification from \"Slack Security\" stating that \"@Matt Brewer has been signed out of all their active sessions in response to a potentially suspicious anomaly event: unexpected_scraping. It provides links to view details in audit logs and learn more.\"",
          "title": "",
          "position": 3
        }
      ],
      "contentSource": "完整文章",
      "content": "As cyberattacks evolve to unprecedented levels of sophistication and speed, the time gap between breach detection and response has never been more critical. Traditional security approaches often operate reactively, identifying compromises only after damage has occurred. This delay grants attackers a tactical advantage, forcing security teams to focus on damage assessment and remediation rather than&#8230;"
    },
    {
      "title": "优化我们的端到端（E2E）流水线 (原标题: Optimizing Our E2E Pipeline)",
      "link": "https://slack.engineering/speedup-e2e-testing/",
      "pubDate": "Mon, 14 Apr 2025 09:00:30 +0000",
      "isoDate": "2025-04-14T09:00:30.000Z",
      "creator": "Dan Carton",
      "summary": "# 优化Slack的端到端（E2E）测试流水线\n\n在DevOps和开发者体验（DevXP）领域，速度和效率对工程师的日常工作至关重要。Slack的DevXP团队通过优化其端到端（E2E）测试流水线，显著降低了构建时间并减少了冗余流程，从而为工程师节省了时间和资源。\n\n## 问题：不必要的UI前端构建\n\nSlack最大的代码仓库（一个单体仓库）在代码合并到`main`分支之前会运行E2E测试，以确保更改在整个Slack应用程序栈（前端、后端、数据库及中间服务）中得到验证。然而，团队发现了一个瓶颈：UI前端代码的构建耗时过长且过于频繁，即使没有前端相关更改。\n\n**现有流程分解：**\n*   开发者提交代码。\n*   UI前端代码构建（约5分钟）。\n*   部署到QA环境。\n*   运行200多个E2E测试（约5分钟）。\n\n整个过程每次运行约10分钟。其中一半时间（约5分钟）被UI前端构建占用，即使没有前端更改。考虑到每天有数百个拉取请求（PR）合并，这些冗余构建不仅耗时，而且成本高昂：\n\n*   每周数千次UI前端构建，每次构建在AWS S3中存储近1GB数据。\n*   其中一半构建与上次合并到`main`的代码相比不包含前端更改，导致数TB的重复数据。\n*   每次构建5分钟的额外延迟，每周累积数千小时的不必要等待。\n\n![端到端测试流水线的阶段](https://slack.engineering/wp-content/uploads/sites/7/2025/04/image4.png?w=640)\n\n## 解决方案：更智能的构建策略与缓存的UI前端资产\n\n为了解决这个问题，团队利用现有工具重新思考了构建策略。\n\n### 步骤1：条件性UI前端构建\n\n*   利用`git diff`的三点表示法来检测当前分支与`main`分支之间最新共同提交的差异。\n*   如果检测到前端更改，则触发UI前端构建作业。\n*   如果未检测到更改，则完全跳过构建，并重用预构建版本。\n\n### 步骤2：预构建资产和内部CDN\n\n*   当不需要UI前端构建时，从AWS S3中查找一个现有的构建（通常是最近的生产版本）。\n*   将为E2E测试提供预构建UI前端资产的任务委托给内部CDN。\n*   这减少了每个PR都需要创建新构建的需求，同时仍确保在当前资产上进行测试。\n\n## 挑战：规模化效率\n\n尽管方法看似简单，但将此解决方案扩展到单体仓库带来了几个挑战：\n\n*   **识别UI前端更改：** 仓库包含超过100,000个跟踪文件。`git`在几秒钟内高效处理了文件跟踪。\n*   **查找预构建资产：** 每天有数百个PR合并到此仓库中，识别足够新的预构建版本需要强大的资产管理。通过使用S3存储概念，团队平衡了新近度、一致的文件命名和性能来管理资产。\n*   **速度：** 平均而言，判断UI前端构建是否不必要并找到最近的构建产物仅需不到3秒。\n\n![端到端流水线描绘了第三阶段的本地预构建前端](https://slack.engineering/wp-content/uploads/sites/7/2025/04/image3.png?w=640)\n\n## 成果：构建频率降低60%，构建时间缩短50%\n\n这些努力带来了显著的改进：\n\n*   **构建频率降低60%：** 通过智能重用预构建的UI前端资产，不必要的UI前端构建数量减少了一半以上。\n*   **每月节省数百小时：** 减少了云计算时间和开发者等待时间。\n*   **节省数TB存储空间：** 每月减少了AWS S3存储数TB，这些重复资产原本会被存储一年。\n*   **构建时间提高50%：** 这是前端DevXP团队及其合作团队的第二个主要项目。第一个项目（升级Webpack设置）将平均构建时间从约10分钟缩短到约5分钟。本项目将平均构建时间从约5分钟缩短到仅约2分钟。两个项目都成功后，E2E流水线的平均构建时间从约10分钟缩短到约2分钟，是年度的巨大改进。\n\n![一月份的基线平均构建时间为10分钟，测试时间为6分钟。到八月份，平均构建时间为2分钟，全年下降了80%。](https://slack.engineering/wp-content/uploads/sites/7/2025/04/image1.png?w=640)\n\n**两个意想不到的成果：**\n\n*   **更可靠、更值得信赖的E2E结果：** 测试的片状性（即尽管没有代码更改，测试仍间歇性或不一致地失败）显著降低。这得益于优化的流水线、对复杂UI前端构建需求的减少以及一致的资产交付。团队观察到测试片状性达到了有史以来的最低百分比。\n*   **重新发现遗留代码：** 实施此优化需要深入研究多年未进行重大修改的多个系统的遗留代码。这次探索提供了宝贵的见解，引发了关于代码库行为的新问题，并生成了未来增强任务的待办事项。\n\n## 结论：重新思考UI前端构建效率\n\n通过战略性地利用`git diff`和内部CDN等现有工具，Slack成功节省了宝贵的开发者时间，降低了云成本，并提高了整体构建效率。对于面临DevOps和DevXP中类似瓶颈的其他公司团队，经验教训是质疑流水线中真正必要的部分，并进行相应优化。虽然这个项目的改进事后看来显而易见，但很容易忽视那些没有彻底失败的系统中的低效率。在Slack的案例中，重新思考如何处理UI前端资产为组织带来了巨大的成功。",
      "shortSummary": "Slack的DevXP团队通过优化其端到端（E2E）测试流水线，显著提升了效率。针对UI前端构建频繁且耗时的问题，团队实施了智能构建策略：利用`git diff`进行条件性构建，并重用通过内部CDN缓存的预构建资产。这使得构建频率降低了60%，平均构建时间从约10分钟缩短至2分钟，节省了大量时间和存储成本。此外，该优化还提高了测试可靠性，并加深了对遗留代码的理解。",
      "translated_title": "优化我们的端到端（E2E）流水线",
      "images": [
        {
          "url": "https://slack.engineering/wp-content/uploads/sites/7/2025/04/image4.png?w=640",
          "alt": "Stages of the end to end testing pipeline.",
          "title": "",
          "position": 1
        },
        {
          "url": "https://slack.engineering/wp-content/uploads/sites/7/2025/04/image3.png?w=640",
          "alt": "End to end pipeline depicting local pre-built frontends at the third stage.",
          "title": "",
          "position": 2
        },
        {
          "url": "https://slack.engineering/wp-content/uploads/sites/7/2025/04/image1.png?w=640",
          "alt": "January baseline was an average build time of 10 minutes and 6 minutes for testing. By August average build time was 2 minutes, an 80% decrease for the year.",
          "title": "",
          "position": 3
        }
      ],
      "contentSource": "完整文章",
      "content": "In the world of DevOps and Developer Experience (DevXP), speed and efficiency can make a big difference on an engineer’s day-to-day tasks. Today, we’ll dive into how Slack’s DevXP team took some existing tools and used them to optimize an end-to-end (E2E) testing pipeline. This lowered build times and reduced redundant processes, saving both time&#8230;"
    },
    {
      "title": "我们如何构建安全私密的智能企业搜索 (原标题: How we built enterprise search to be secure and private)",
      "link": "https://slack.engineering/how-we-built-enterprise-search-to-be-secure-and-private/",
      "pubDate": "Fri, 07 Mar 2025 01:14:37 +0000",
      "isoDate": "2025-03-07T01:14:37.000Z",
      "creator": "Ian Hoffman",
      "summary": "### 引言：Slack的演进\n\n“Slack”实际上是一个逆向首字母缩略词，代表“Searchable Log of all Communication and Knowledge”（所有通信和知识的可搜索日志）。如今，借助Slack AI，Slack已不仅仅是一个可搜索的日志，它利用最新的生成式AI技术，安全地提供强大且省时的洞察，成为一个智能日志。\n\n### Slack AI的安全与隐私原则\n\nSlack AI从零开始构建，遵循与现有企业级合规标准相同的安全和隐私原则：\n\n*   **客户数据永不离开Slack：** 确保客户信息始终在Slack的信任边界内。\n*   **不使用客户数据训练大型语言模型（LLMs）：** 保护客户数据的隐私性，避免其被用于模型训练。\n*   **Slack AI仅处理用户可见的数据：** 确保AI的响应仅基于用户已有权限访问的信息。\n*   **与现有企业级合规标准无缝集成：** 兼容既有的安全和合规框架。\n\n### 企业搜索的扩展与功能\n\n现在，通过企业搜索，Slack不仅是其内部所有内容和知识的日志，还包括来自关键外部应用程序的知识。用户可以直接在Slack的搜索中找到最新、相关且有权限的内容。目前已支持Google Drive和GitHub，未来还将集成更多连接的应用。这些新应用的加入，使得Slack搜索和AI答案能够从关键工具中获取上下文，从而更强大地满足用户查询。\n\n### 企业搜索的安全与隐私原则\n\n企业搜索秉承与Slack AI相同的企业级安全和隐私标准：\n\n*   **从不存储外部数据：** 外部数据不会存储在Slack的数据库中。\n*   **外部数据和权限实时更新：** 确保从外部系统获取的数据和权限始终是最新的。\n*   **用户和管理员需明确授权：** 必须明确授予Slack访问外部源的权限，并可随时撤销。\n*   **遵循最小权限原则：** 仅请求满足搜索查询所需的授权。\n\n### Slack AI如何保障安全\n\n*   **托管LLMs在托管VPC中：** Slack使用AWS在托管VPC中托管闭源LLMs，确保模型提供商无法访问Slack客户数据，且客户数据永不离开Slack的信任边界。\n*   **采用检索增强生成（RAG）：** 不通过训练LLMs来处理数据，而是使用RAG，仅向LLM提供完成任务所需的、用户有权限访问的内容。这些内容只在运行时提供给LLM，LLM不会保留任何用户数据。\n*   **权限感知：** Slack利用请求用户的访问控制列表（ACL），确保LLM只接收用户在Slack中已有权限访问的数据。\n*   **重用现有合规基础设施：** 存储和处理LLM生成内容时，重用所有现有合规基础设施（如加密密钥管理和国际数据驻留）。搜索答案摘要不会被存储，仅显示给请求用户后立即丢弃。\n\n### 企业搜索如何保障安全\n\n企业搜索建立在Slack AI之上，并受益于其多项创新（例如使用相同的LLMs、RAG，且不存储搜索答案）。此外，企业搜索增加了从外部源提供有权限内容的能力：\n\n*   **不存储外部数据：** 采用联邦式实时方法，通过合作伙伴的公共搜索API返回最新、有权限的结果。Slack客户端可能会缓存数据以优化性能，但核心数据不存储。\n*   **数据和权限实时更新：** 实时从外部源获取数据，避免数据过时。通过OAuth协议，确保企业搜索只能执行用户授权的操作，且这些操作是用户自身可执行操作的子集。\n*   **用户明确授权：** Slack管理员必须选择启用每个外部源用于组织搜索，并可随时撤销。同样，Slack用户也需明确授权，并可随时撤销。这得益于基于OAuth的方法。\n*   **最小权限原则：** 连接外部系统时，仅请求满足搜索查询所需的OAuth读取权限。Slack会向管理员和最终用户展示计划请求的权限范围，确保透明度。\n\n### 结论\n\nSalesforce将信任视为首要价值。Slack自豪地构建了以安全和隐私为核心的企业搜索体验，它建立在Slack AI已有的强大安全原则之上。客户可以放心地使用这一强大新功能，因为他们的外部数据始终得到妥善保护。",
      "shortSummary": "Slack推出了基于其AI技术的企业搜索功能，将搜索范围从内部扩展到Google Drive、GitHub等外部应用。该功能严格遵循安全和隐私原则：客户数据不离开Slack，不用于训练LLM，仅处理用户有权限访问的数据。企业搜索不存储外部数据，采用实时联邦查询，并通过OAuth确保用户明确授权和最小权限访问。其核心目标是提供安全、私密且高效的跨应用内容检索体验，将信任置于首位。",
      "translated_title": "我们如何构建安全私密的智能企业搜索",
      "images": [],
      "contentSource": "RSS",
      "content": "Many don’t know that “Slack” is in fact a backronym—it stands for “Searchable Log of all Communication and Knowledge”. And these days, it’s not just a searchable log: with Slack AI, Slack is now an intelligent log, leveraging the latest in generative AI to securely surface powerful, time-saving insights. We built Slack AI from the&#8230;"
    },
    {
      "title": "Slack 的自动化无障碍测试 (原标题: Automated Accessibility Testing at Slack)",
      "link": "https://slack.engineering/automated-accessibility-testing-at-slack/",
      "pubDate": "Tue, 07 Jan 2025 20:46:20 +0000",
      "isoDate": "2025-01-07T20:46:20.000Z",
      "creator": "nstormann",
      "summary": "在 Slack，客户满意度是首要任务，而无障碍性是客户信任的核心要素。为了确保产品功能符合 Web 内容无障碍指南 (WCAG)，Slack 制定了内部无障碍标准，并设有专门的无障碍团队支持开发人员。除了与外部手动测试人员合作外，Slack 在2022年开始引入桌面自动化无障碍测试，作为其整体测试策略的补充。这项策略还包括让残障人士早期参与设计过程、进行设计和原型评审，以及对所有支持的辅助技术进行手动测试。尽管自动化工具可能无法发现需要人工判断的细微无障碍问题（如屏幕阅读器可用性）或可能误报不符合产品特定设计考虑的问题，但 Slack 仍认为将其集成到现有测试框架中具有重要价值。\n\n### 探索与局限性\n\n**意外的复杂性：Axe、Jest 和 React Testing Library (RTL)**\n\nSlack 选择了流行的无障碍测试工具 Axe，因为它功能广泛、易于配置且与现有端到端 (E2E) 测试框架兼容。Axe 能够检查多种无障碍指南，并最大限度地减少误报。最初，团队尝试将 Axe 检查直接嵌入到 React Testing Library (RTL) 框架中，通过自定义 `render` 函数来简化开发流程。然而，由于 Slack 定制的 Jest 设置，这种方法遇到了问题。虽然通过单独的 Jest 配置运行检查可行，但这会要求开发人员专门为无障碍性编写测试，这与团队的初衷相悖。修改自定义 Jest 设置被认为过于复杂且不值得投入时间和资源，因此团队转向了 Playwright 框架。\n\n**Axe 检查的最佳解决方案：Playwright**\n\n在排除了 Jest 后，Slack 转向了其 E2E 测试框架 Playwright。Playwright 通过 `@axe-core/playwright` 包支持 Axe 无障碍测试。Axe Core 提供了过滤和自定义无障碍检查所需的大部分功能，包括排除特定规则和选择器，以及使用无障碍标签（如 'wcag2a'、'wcag2aa'）来指定分析类型。最初的目标是将无障碍检查“烘焙”到 Playwright 的交互方法中（如点击和导航），使其自动运行。然而，Playwright 的 `Locator` 对象带来了挑战。`Locator` 旨在简化与页面元素的交互，但它只确保单个元素的就绪性，而非整个页面的完全渲染。在错误时机运行检查可能导致遗漏问题。使用已弃用的方法（如 `waitForElement`）来控制检查触发时机也存在性能下降、错误重复和与 Playwright 抽象模型冲突的问题。因此，尽管将 Axe 检查嵌入到 Playwright 核心交互方法中看似理想，但 Playwright 内部机制的复杂性促使团队探索其他解决方案。\n\n### 定制与变通方案\n\n为了克服将无障碍检查嵌入框架的障碍，团队做出了一些让步，同时仍优先考虑简化的开发人员工作流程。他们继续专注于 Playwright，因为它在选择性地隐藏或应用无障碍检查方面提供了更大的灵活性，从而更容易管理检查的运行时间和地点。此外，Axe Core 也提供了出色的定制功能，例如过滤规则和使用特定的无障碍标签。\n\n使用 `@axe-core/playwright` 包，无障碍检查流程如下：\n\n1.  Playwright 测试加载页面/视图。\n2.  Axe 分析页面。\n3.  过滤掉预定义的排除项。\n4.  违规和工件被保存到文件中。\n\n团队设置了主函数 `runAxeAndSaveViolations`，并使用 AxeBuilder 类提供的功能自定义了范围，以检查 WCAG 2.1 A 级和 AA 级的合规性。他们还创建了一个选择器列表，用于从违规报告中排除已知问题和不适用的规则。为了避免重复并控制报告的严重性，团队创建了方法来检查每个违规的唯一性，并只报告被认为是“Critical”级别的违规。\n\n团队利用了 Playwright 的 fixture 模型，将无障碍辅助函数集成到现有的 `slack` fixture 中，从而使测试作者可以直接在测试规范中调用它，减少了开销。此外，他们还定制了 Playwright 的 `test.step`，添加了自定义标签“Running accessibility checks in runAxeAndSaveViolations”，以便更容易检测到无障碍违规发生的位置。\n\n![图片 1](https://slack.engineering/wp-content/uploads/sites/7/2024/12/joachim-schnurle-4j732BLw0BI-unsplash.jpg?w=640)\n\n### 无障碍检查在端到端测试中的放置\n\n为了启动项目，团队建立了一个与 Slack 关键功能测试套件镜像的测试套件，并将其重命名为无障碍测试套件，设置为非阻塞运行。这意味着开发人员将看到测试结果，但失败或违规不会阻止他们将代码合并到生产环境。这个初始套件总共包含 91 个测试。\n\n在策略上，团队考虑了在这些关键流程测试中放置无障碍检查的位置。通常，目标是在测试中覆盖的每个新视图、页面或流程之后添加一个无障碍检查。在大多数情况下，这意味着在按钮点击或导致导航的链接之后直接放置检查。在其他情况下，检查需要在第二个用户登录或重定向之后放置。重要的是要确保在一次测试中或在具有相同 UI 流程的多个测试中，同一视图不会被分析两次，以避免不必要的错误消息、保存工件和测试速度减慢。团队还小心地确保 Axe 调用只在页面或视图完全加载且所有内容渲染完成后才进行。这种方法要求团队深入了解应用程序和每个测试用例的上下文。\n\n![图片 2](https://slack.engineering/wp-content/uploads/sites/7/2024/12/krystian-tambur-k7rZ8wTfABA-unsplash.jpg?w=640)\n\n### 违规报告\n\n团队花费了一些时间迭代改进无障碍违规报告。最初，他们创建了一个简单的文本文件来保存本地运行的结果。根据开发人员的早期反馈，他们集成了 Playwright 的截图功能，并将截图与文本报告一起保存在同一个工件文件夹中。为了使报告更具连贯性和可读性，团队利用了 Playwright HTML Reporter。这个工具不仅聚合测试结果，还允许将截图和违规报告等工件附加到 HTML 输出中，从而在一个测试报告中显示所有无障碍工件。最后，为了使违规错误消息更有帮助且易于理解，团队编写了代码来提取违规的关键信息，并通过解析和精简错误消息来定制违规在报告和控制台中的显示方式。\n\n### 环境设置和运行测试\n\n一旦集成了 Axe 检查并设置了测试套件，团队就需要确定开发人员如何以及何时运行它们。为了简化开发人员的工作流程，他们引入了一个环境变量 `A11Y_ENABLE` 来控制框架中无障碍检查的激活，默认设置为 false 以防止不必要的运行。这种设置允许开发人员选择：\n\n*   **按需测试：** 开发人员可以在需要时手动启用该标志，在其分支上本地运行无障碍检查。\n*   **计划运行：** 开发人员可以配置在非高峰时段进行定期运行。Slack 在 Buildkite 中配置了每日回归运行，将无障碍测试运行结果每日发送到 Slack 警报通道。\n*   **CI 集成：** 可选地，可以在持续集成管道中启用该标志，以便在合并重大更改之前进行彻底测试。\n\n### 分类和所有权\n\n测试的所有权和维护是常见的问题。在将 Axe 调用添加到 Playwright E2E 测试的关键流程后，团队需要决定谁将负责分类通过自动化发现的无障碍问题，以及谁将负责现有测试的维护。在 Slack，开发人员负责其测试的创建和维护。为了支持开发人员更好地理解框架更改和新的无障碍自动化，团队创建了文档，并与内部 Slack 无障碍团队合作，制定了一个全面的分类流程，以适应他们现有的无障碍问题分类工作流程。Slack 的内部无障碍团队已经建立了分类和标记传入无障碍问题的流程，并以内部 Slack 无障碍标准为指导。为了增强流程，他们创建了一个新的“automated accessibility”标签来追踪通过自动化发现的问题。为了方便这些问题的编目，他们还在警报通道中设置了一个 Jira 工作流，可以自动创建带有预填充模板的 Jira 工单。该工单通过工作流创建，并自动标记为“automated accessibility”并放入 Jira Epic 中进行分类。\n\n### 执行审计\n\n团队定期对无障碍 Playwright 调用进行审计，以检查 Axe 调用的重复性，并确保无障碍覆盖的适当性。",
      "shortSummary": "Slack 将无障碍性视为客户信任的核心，并于2022年引入桌面自动化无障碍测试，作为其全面测试策略的补充。团队选择 Axe 工具并将其集成到 Playwright E2E 测试框架中，克服了与 Jest 集成时的复杂性。通过定制化，实现了无障碍检查的自动化运行、优化了违规报告（包含截图），并建立了清晰的问题分类和所有权流程。自动化测试结果通过 Jira 工作流自动创建工单，并定期进行审计，旨在提高效率并及早发现无障碍问题。",
      "translated_title": "Slack 的自动化无障碍测试",
      "images": [
        {
          "url": "https://slack.engineering/wp-content/uploads/sites/7/2024/12/joachim-schnurle-4j732BLw0BI-unsplash.jpg?w=640",
          "alt": "",
          "title": "",
          "position": 1
        },
        {
          "url": "https://slack.engineering/wp-content/uploads/sites/7/2024/12/krystian-tambur-k7rZ8wTfABA-unsplash.jpg?w=640",
          "alt": "",
          "title": "",
          "position": 2
        }
      ],
      "contentSource": "完整文章",
      "content": "At Slack, customer love is our first priority and accessibility is a core tenet of customer trust. We have our own Slack Accessibility Standards that product teams follow to guarantee their features are compliant with Web Content Accessibility Guidelines (WCAG). Our dedicated accessibility team supports developers in following these guidelines throughout the development process. We&#8230;"
    },
    {
      "title": "迁移自动化：借助AI简化Jenkins到GHA的迁移 (原标题: Migration Automation: Easing the Jenkins → GHA shift with help from AI)",
      "link": "https://slack.engineering/migration-automation-easing-the-jenkins-%e2%86%92-gha-shift-with-help-from-ai/",
      "pubDate": "Mon, 16 Dec 2024 09:00:03 +0000",
      "isoDate": "2024-12-16T09:00:03.000Z",
      "creator": "Zhengyu Shen",
      "summary": "Slack的CI基础设施近期经历了一次重大变革，从长期困扰开发人员的Jenkins迁移至GitHub Actions (GHA)。为了加速这一过程并减轻手动迁移的负担，Slack的一名实习生开发了一个自动化转换工具，旨在将Jenkins流水线自动迁移到GitHub Actions。该项目取得了成功，预计将迁移时间缩短一半，并节省超过1300小时的开发时间。\n\n### 项目概述与目标\n\n*   **背景**：Jenkins在安全性、停机时间和用户体验方面的问题促使Slack决定将大部分CI作业迁移到GitHub Actions。\n*   **核心目标**：创建一个能够自动迁移Jenkins流水线到GitHub Actions的转换工具。\n*   **成功标准**：\n    *   开发自动化工具以解决手动迁移的困难。\n    *   将工具应用于大量现有Jenkins作业。\n    *   创建关于转换过程的文档。\n*   **关键术语**：\n    *   **流水线 (Pipeline)**：Jenkins中用于组织作业的一组插件。项目开始时有242个Jenkins流水线待迁移。\n    *   **实例 (Instance)**：Jenkins流水线托管的Jenkins实例，需从3个实例迁移。\n    *   **工作流 (Workflow)**：GitHub Actions CI作业。\n    *   **GHA**：GitHub Actions的缩写。\n\n### 解决方案设计与实施\n\n项目分为三个主要部分：\n\n#### 第一部分：GitHub Actions Importer的使用\n\n*   **工具介绍**：GitHub Actions Importer是GitHub发布的一个工具，可以审计Jenkins实例并尝试将所有流水线转换为GitHub Actions工作流。\n*   **性能表现**：\n    *   约50%的流水线能够完全无误地从Jenkins迁移到GHA。\n    *   约5%的迁移完全失败。\n    *   其余的作业（约45%）是部分导入，即生成了工作流YAML文件但未能完全填充。\n*   **关键发现**：虽然有数百个流水线未能完全转换，但深入检查发现，90%以上的失败是由仅八个不受支持的Jenkins构建步骤和环境引起的。这使得后续的修正工作得以集中。\n\n#### 第二部分：研究与修正类型识别\n\n在了解了Importer的局限性后，项目团队识别出需要对生成的YAML文件进行四种主要类型的修正：\n\n1.  **替换限速操作为内部镜像 (RoI: 很高)**：\n    *   **问题**：默认情况下，GitHub Actions市场上的操作会受到github.com API的速率限制。\n    *   **解决方案**：替换为Slack内部GitHub Enterprise实例上的内部镜像操作，这些操作具有更高的速率限制。\n    *   **价值**：避免因速率限制导致作业失败，提升用户体验。\n2.  **替换操作为其他操作 (RoI: 高)**：\n    *   **问题**：Importer有时会选择某个操作，而Slack更倾向于使用内部或更合适的其他操作（例如，将`rtCamp/action-slack-notify`替换为Slack内部的消息发送操作）。\n    *   **解决方案**：利用大型语言模型（LLM）进行替换，因为不同操作的语法差异较大，难以通过简单的字符串方法转换。\n    *   **价值**：节省终端用户学习和适应不同操作的时间和精力。\n3.  **为终端用户添加有用注释 (RoI: 中等)**：\n    *   **问题**：某些工作流文件中的操作项（如访问秘密）无法自动化，因为秘密存储在GitHub外部，且迁移到GitHub不符合安全策略。\n    *   **解决方案**：在无法自动化的部分留下注释，指导用户如何手动修改以从正确位置读取秘密。\n    *   **价值**：为用户提供明确的修复方向，尽管仍需手动操作。\n4.  **删除不必要的注释 (RoI: 低-中等)**：\n    *   **问题**：Importer在遇到不支持的Jenkins项时会留下“X Jenkins项不受支持”的注释。但很多情况下，这些功能在GHA中已包含或不再需要。\n    *   **解决方案**：删除这些不重要的注释，以清理工作流文件。\n    *   **价值**：使工作流更简洁，虽然收益较小，但脚本实现简单。\n\n#### 第三部分：修正工具的开发\n\n*   **架构**：修正工具的输入是包含工作流YAML文件的目录路径。工具会遍历每个YAML文件，先进行所有非AI修正，再进行所有AI修正，并原地修改文件内容。\n*   **非AI修正实现**：主要使用Python的`String.replace()`方法来处理简单的字符串替换和注释添加。\n*   **AI修正实现**：\n    *   **提示工程 (Prompt Engineering)**：结合科学（结构化提示：上下文设置、具体步骤、输出指令）和艺术（实验与迭代）。\n    *   **示例提示**：详细指导LLM将`rtCamp/action-slack-notify`替换为`slack/message-action`，并指定如何处理参数映射，同时强调不要删除注释或修改其他操作。\n    *   **LLM表现**：对约24个LLM输出的检查显示，其在执行请求任务时达到了100%的准确率，这打消了对幻觉和其他意外副作用的担忧。LLM在处理Python字符串方法难以解决的复杂替换任务中发挥了关键作用。\n\n### 影响与用户反馈\n\n*   **效率提升**：该转换工具让终端用户完全跳过了手动编写GHA工作流的第一步，并极大地简化了第二步的调试工作，因为生成的GHA工作流文件准确性很高，几乎没有缺陷。\n*   **时间节省**：对于242个待迁移的流水线，根据开发人员经验的不同，手动转换每个流水线可能需要2到10小时。该工具的自动化能力显著减少了所需时间，实现了项目预期的总时间节省。\n*   **总结**：LLM在迁移过程中非常有用，尽管提示工程并非微不足道，但其投入时间不长，且LLM在“替换A为B”的任务上表现与人类一样出色，填补了Python字符串方法难以解决的复杂错误修正的空白。",
      "shortSummary": "Slack通过一个AI辅助的自动化工具，成功将其CI作业从Jenkins迁移到GitHub Actions (GHA)。该工具由一名实习生开发，结合了GitHub Actions Importer、Python脚本和大型语言模型（LLM），能够自动修正和优化转换后的GHA工作流。LLM在复杂的操作替换任务中表现出100%的准确率。此举将迁移时间缩短了一半，预计为Slack节省超过1300小时的开发工作，显著提高了迁移效率和准确性。",
      "translated_title": "迁移自动化：借助AI简化Jenkins到GHA的迁移",
      "images": [],
      "contentSource": "RSS",
      "content": "Overview The past few months have been exciting times for Slack’s CI infrastructure. After years of developer frustration with Jenkins (everything from security issues to downtime to generally poor UX) internal pressure led us to move a majority of Slack’s CI jobs from Jenkins to GitHub Actions.  My intern project at Slack this summer involved&#8230;"
    }
  ],
  "lastUpdated": "2026-01-27T04:54:37.450Z"
}