{
  "sourceUrl": "https://netflixtechblog.com/feed",
  "title": "Netflix TechBlog - Medium",
  "description": "Learn about Netflix’s world class engineering efforts, company culture, product developments and more. - Medium",
  "link": "https://netflixtechblog.com?source=rss----2615bd06b42e---4",
  "items": [
    {
      "title": "FM-Intent：使用分层多任务学习预测用户会话意图 (原标题: FM-Intent: Predicting User Session Intent with Hierarchical Multi-Task Learning)",
      "link": "https://netflixtechblog.com/fm-intent-predicting-user-session-intent-with-hierarchical-multi-task-learning-94c75e18f4b8?source=rss----2615bd06b42e---4",
      "pubDate": "Wed, 21 May 2025 16:28:07 GMT",
      "isoDate": "2025-05-21T16:28:07.000Z",
      "creator": "Netflix Technology Blog",
      "summary": "本文介绍了FM-Intent，一种新颖的推荐模型，旨在通过分层多任务学习来增强Netflix的推荐基础模型，从而预测用户会话意图并改进推荐。\n\n*   **动机：** 现有推荐系统可以通过预测用户意图来进一步增强，从而提供更全面和细致的推荐体验。\n*   **方法：** FM-Intent使用短期和长期隐式信号作为代理来捕获用户的潜在会话意图，然后利用此意图预测来改进下一个项目的推荐。\n*   **关键贡献：**\n    *   提出了一种新的推荐模型，该模型可以捕获Netflix平台上的用户意图，并使用此意图信息来增强下一个项目的预测。\n    *   提出了一种分层多任务学习方法，可以有效地建模短期和长期用户兴趣。\n    *   通过全面的实验验证，表明与包括Netflix基础模型在内的最新模型相比，性能得到了显着提高。\n*   **用户意图：** 在Netflix生态系统中，用户意图通过各种交互元数据体现出来，例如操作类型、类型偏好、电影/节目类型以及发布时间。\n*   **模型架构：** FM-Intent采用具有三个主要组成部分的分层多任务学习方法：输入特征序列形成、用户意图预测以及具有分层多任务学习的下一个项目预测。\n*   **实验结果：** 实验表明，与现有模型相比，FM-Intent在下一个项目预测准确性方面有了显着提高，并且可以生成有意义的用户意图嵌入，用于对具有相似意图的用户进行聚类。\n*   **潜在应用：** FM-Intent可以用于个性化UI优化、分析和用户理解、增强推荐信号以及搜索优化。\n\n![图片 1](https://cdn-images-1.medium.com/max/1024/0*3pMgS5u3TepefPLB)\nFigure 1: Overview of user engagement data in Netflix. User intent can be associated with several interaction metadata. We leverage various implicit signals to predict user intent and next-item.\n\n![图片 2](https://cdn-images-1.medium.com/max/624/1*TO3z9jPiu2QZR-xnL7erMQ.png)\nFigure 2: An architectural illustration of our hierarchical multi-task learning model FM-Intent for user intent and item predictions. We use ground-truth intent and item-ID labels to optimize predictions.\n\n![图片 3](https://cdn-images-1.medium.com/max/1024/0*7h7aSQhq7U_heAUu)\nTable 1: Next-item and next-intent prediction results of baselines and our proposed method FM-Intent on the Netflix user engagement dataset.\n\n![图片 4](https://cdn-images-1.medium.com/max/1024/0*nBqH-ZHRXRfR3-e0)\nFigure 3: K-means++ (K=10) clustering of user intent embeddings found by FM-Intent; FM-Intent finds unique clusters of users that share the similar intent.",
      "translated_title": "FM-Intent：使用分层多任务学习预测用户会话意图",
      "images": [
        {
          "url": "https://cdn-images-1.medium.com/max/1024/0*3pMgS5u3TepefPLB",
          "alt": "",
          "title": "",
          "position": 1
        },
        {
          "url": "https://cdn-images-1.medium.com/max/624/1*TO3z9jPiu2QZR-xnL7erMQ.png",
          "alt": "",
          "title": "",
          "position": 2
        },
        {
          "url": "https://cdn-images-1.medium.com/max/1024/0*7h7aSQhq7U_heAUu",
          "alt": "",
          "title": "",
          "position": 3
        },
        {
          "url": "https://cdn-images-1.medium.com/max/1024/0*nBqH-ZHRXRfR3-e0",
          "alt": "",
          "title": "",
          "position": 4
        },
        {
          "url": "https://medium.com/_/stat?event=post.clientViewed&referrerSource=full_rss&postId=94c75e18f4b8",
          "alt": "",
          "title": "",
          "position": 5
        }
      ],
      "contentSource": "RSS",
      "content": "<p>Authors: <a href=\"https://www.linkedin.com/in/sejoon-oh/\">Sejoon Oh</a>, <a href=\"https://www.linkedin.com/in/moumitab/\">Moumita Bhattacharya</a>, <a href=\"https://www.linkedin.com/in/yesufeng/\">Yesu Feng</a>, <a href=\"https://www.linkedin.com/in/sudarshanlamkhede/\">Sudarshan Lamkhede</a>, <a href=\"https://www.linkedin.com/in/markhsiao/\">Ko-Jen Hsiao</a>, and <a href=\"https://www.linkedin.com/in/jbasilico/\">Justin Basilico</a></p><h3>Motivation</h3><p>Recommender systems have become essential components of digital services across e-commerce, streaming media, and social networks [1, 2]. At Netflix, these systems drive significant product and business impact by connecting members with relevant content at the right time [3, 4]. While our recommendation <strong>foundation model (FM)</strong> has made substantial progress in understanding user preferences through large-scale learning from interaction histories (please refer to this <a href=\"https://netflixtechblog.medium.com/foundation-model-for-personalized-recommendation-1a0bd8e02d39\"><strong><em>article</em></strong></a> about FM @ Netflix), there is an opportunity to further enhance its capabilities. By extending FM to incorporate the prediction of underlying user intents, we aim to enrich its understanding of user sessions beyond next-item prediction, thereby offering a more comprehensive and nuanced recommendation experience.</p><p>Recent research has highlighted the importance of understanding user intent in online platforms [5, 6, 7, 8]. As Xia et al. [8] demonstrated at Pinterest, predicting a user’s future intent can lead to more accurate and personalized recommendations. However, existing intent prediction approaches typically employ simple multi-task learning that adds intent prediction heads to next-item prediction models without establishing a hierarchical relationship between these tasks.</p><p>To address these limitations, we introduce <strong><em>FM-Intent</em></strong>, a novel recommendation model that enhances our foundation model through hierarchical multi-task learning. FM-Intent captures a user’s latent session intent using both short-term and long-term implicit signals as proxies, then leverages this intent prediction to improve next-item recommendations. Unlike conventional approaches, FM-Intent establishes a clear hierarchy where intent predictions directly inform item recommendations, creating a more coherent and effective recommendation pipeline.</p><p>FM-Intent makes three key contributions:</p><ol><li>A novel recommendation model that captures user intent on the Netflix platform and enhances next-item prediction using this intent information.</li><li>A hierarchical multi-task learning approach that effectively models both short-term and long-term user interests.</li><li>Comprehensive experimental validation showing significant performance improvements over state-of-the-art models, including our foundation model.</li></ol><h3>Understanding User Intent in Netflix</h3><p>In the Netflix ecosystem, user intent manifests through various interaction metadata, as illustrated in Figure 1. FM-Intent leverages these implicit signals to predict both user intent and next-item recommendations.</p><figure><img alt=\"\" src=\"https://cdn-images-1.medium.com/max/1024/0*3pMgS5u3TepefPLB\" /></figure><p><em>Figure 1: Overview of user engagement data in Netflix. User intent can be associated with several interaction metadata. We leverage various implicit signals to predict user intent and next-item.</em></p><p>In Netflix, there can be multiple types of user intents. For instance,</p><blockquote><strong><em>Action Type</em></strong>: Categories reflecting what users intend to do on Netflix, such as discovering new content versus continuing previously started content. For example, when a member plays a follow-up episode of something they were already watching, this can be categorized as “continue watching” intent.</blockquote><blockquote><strong><em>Genre Preference</em></strong>: The pre-defined genre labels (e.g., Action, Thriller, Comedy) that indicate a user’s content preferences during a session. These preferences can shift significantly between sessions, even for the same user.</blockquote><blockquote><strong><em>Movie/Show Type</em></strong>: Whether a user is looking for a movie (typically a single, longer viewing experience) or a TV show (potentially multiple episodes of shorter duration).</blockquote><blockquote><strong><em>Time-since-release</em></strong>: Whether the user prefers newly released content, recent content (e.g., between a week and a month), or evergreen catalog titles.</blockquote><p>These dimensions serve as proxies for the latent user intent, which is often not directly observable but crucial for providing relevant recommendations.</p><h3>FM-Intent Model Architecture</h3><p>FM-Intent employs a hierarchical multi-task learning approach with three major components, as illustrated in Figure 2.</p><figure><img alt=\"\" src=\"https://cdn-images-1.medium.com/max/624/1*TO3z9jPiu2QZR-xnL7erMQ.png\" /></figure><p><em>Figure 2: An architectural illustration of our hierarchical multi-task learning model FM-Intent for user intent and item predictions. We use ground-truth intent and item-ID labels to optimize predictions.</em></p><h4>1. Input Feature Sequence Formation</h4><p>The first component constructs rich input features by combining interaction metadata. The input feature for each interaction combines categorical embeddings and numerical features, creating a comprehensive representation of user behavior.</p><h4>2. User Intent Prediction</h4><p>The intent prediction component processes the input feature sequence through a Transformer encoder and generates predictions for multiple intent signals.</p><p>The Transformer encoder effectively models the long-term interest of users through multi-head attention mechanisms. For each prediction task, the intent encoding is transformed into prediction scores via fully-connected layers.</p><p>A key innovation in FM-Intent is the attention-based aggregation of individual intent predictions. This approach generates a comprehensive intent embedding that captures the relative importance of different intent signals for each user, providing valuable insights for personalization and explanation.</p><h4>3. Next-Item Prediction with Hierarchical Multi-Task Learning</h4><p>The final component combines the input features with the user intent embedding to make more accurate next-item recommendations.</p><p>FM-Intent employs hierarchical multi-task learning where intent predictions are conducted first, and their results are used as input features for the next-item prediction task. This hierarchical relationship ensures that the next-item recommendations are informed by the predicted user intent, creating a more coherent and effective recommendation model.</p><h3>Offline Results</h3><p>We conducted comprehensive offline experiments on sampled Netflix user engagement data to evaluate FM-Intent’s performance. Note that FM-Intent uses a much smaller dataset for training compared to the FM production model due to its complex hierarchical prediction architecture.</p><h4>Next-Item and Next-Intent Prediction Accuracy</h4><p>Table 1 compares FM-Intent with several state-of-the-art sequential recommendation models, including our production model (FM-Intent-V0).</p><figure><img alt=\"\" src=\"https://cdn-images-1.medium.com/max/1024/0*7h7aSQhq7U_heAUu\" /></figure><p><em>Table 1: Next-item and next-intent prediction results of baselines and our proposed method FM-Intent on the Netflix user engagement dataset.</em></p><p>All metrics are represented as relative % improvements compared to the SOTA baseline: TransAct. N/A indicates that a model is not capable of predicting a certain intent. Note that we added additional fully-connected layers to LSTM, GRU, and Transformer baselines in order to predict user intent, while we used original implementations for other baselines. FM-Intent demonstrates statistically significant improvement of 7.4% in next-item prediction accuracy compared to the best baseline (TransAct).</p><p>Most baseline models show limited performance as they either cannot predict user intent or cannot incorporate intent predictions into next-item recommendations. Our production model (FM-Intent-V0) performs well but lacks the ability to predict and leverage user intent. Note that FM-Intent-V0 is trained with a smaller dataset for a fair comparison with other models; the actual production model is trained with a much larger dataset.</p><h3>Qualitative Analysis: User Clustering</h3><figure><img alt=\"\" src=\"https://cdn-images-1.medium.com/max/1024/0*nBqH-ZHRXRfR3-e0\" /></figure><p><em>Figure 3: K-means++ (K=10) clustering of user intent embeddings found by FM-Intent; FM-Intent finds unique clusters of users that share the similar intent.</em></p><p>FM-Intent generates meaningful user intent embeddings that can be used for clustering users with similar intents. Figure 3 visualizes 10 distinct clusters identified through K-means++ clustering.<em> </em>These clusters reveal meaningful user segments with distinct viewing patterns:</p><ul><li>Users who primarily discover new content versus those who continue watching recent/favorite content.</li><li>Genre enthusiasts (e.g., <em>anime/kids content viewers</em>).</li><li>Users with specific viewing patterns (e.g., <em>Rewatchers</em> versus <em>casual viewers</em>).</li></ul><h3>Potential Applications of FM-Intent</h3><p>FM-Intent has been successfully integrated into Netflix’s recommendation ecosystem, can be leveraged for several downstream applications:</p><blockquote><strong>Personalized UI Optimization</strong>: The predicted user intent could inform the layout and content selection on the Netflix homepage, emphasizing different rows based on whether users are in discovery mode, continue-watching mode, or exploring specific genres.</blockquote><blockquote><strong>Analytics and User Understanding</strong>: Intent embeddings and clusters provide valuable insights into viewing patterns and preferences, informing content acquisition and production decisions.</blockquote><blockquote><strong>Enhanced Recommendation Signals</strong>: Intent predictions serve as features for other recommendation models, improving their accuracy and relevance.</blockquote><blockquote><strong>Search Optimization</strong>: Real-time intent predictions help prioritize search results based on the user’s current session intent.</blockquote><h3>Conclusion</h3><p>FM-Intent represents an advancement in Netflix’s recommendation capabilities by enhancing them with hierarchical multi-task learning for user intent prediction. Our comprehensive experiments demonstrate that FM-Intent significantly outperforms state-of-the-art models, including our prior foundation model that focused solely on next-item prediction. By understanding not just what users might watch next but what underlying intents users have, we can provide more personalized, relevant, and satisfying recommendations.</p><h3>Acknowledgements</h3><p>We thank our stunning colleagues in the Foundation Model team &amp; AIMS org. for their valuable feedback and discussions. We also thank our partner teams for getting this up and running in production.</p><h3>References</h3><p>[1] Amatriain, X., &amp; Basilico, J. (2015). Recommender systems in industry: A netflix case study. In Recommender systems handbook (pp. 385–419). Springer.</p><p>[2] Gomez-Uribe, C. A., &amp; Hunt, N. (2015). The netflix recommender system: Algorithms, business value, and innovation. ACM Transactions on Management Information Systems (TMIS), 6(4), 1–19.</p><p>[3] Jannach, D., &amp; Jugovac, M. (2019). Measuring the business value of recommender systems. ACM Transactions on Management Information Systems (TMIS), 10(4), 1–23.</p><p>[4] Bhattacharya, M., &amp; Lamkhede, S. (2022). Augmenting Netflix Search with In-Session Adapted Recommendations. In Proceedings of the 16th ACM Conference on Recommender Systems (pp. 542–545).</p><p>[5] Chen, Y., Liu, Z., Li, J., McAuley, J., &amp; Xiong, C. (2022). Intent contrastive learning for sequential recommendation. In Proceedings of the ACM Web Conference 2022 (pp. 2172–2182).</p><p>[6] Ding, Y., Ma, Y., Wong, W. K., &amp; Chua, T. S. (2021). Modeling instant user intent and content-level transition for sequential fashion recommendation. IEEE Transactions on Multimedia, 24, 2687–2700.</p><p>[7] Liu, Z., Chen, H., Sun, F., Xie, X., Gao, J., Ding, B., &amp; Shen, Y. (2021). Intent preference decoupling for user representation on online recommender system. In Proceedings of the Twenty-Ninth International Conference on International Joint Conferences on Artificial Intelligence (pp. 2575–2582).</p><p>[8] Xia, X., Eksombatchai, P., Pancha, N., Badani, D. D., Wang, P. W., Gu, N., Joshi, S. V., Farahpour, N., Zhang, Z., &amp; Zhai, A. (2023). TransAct: Transformer-based Realtime User Action Model for Recommendation at Pinterest. In Proceedings of the 29th ACM SIGKDD Conference on Knowledge Discovery and Data Mining (pp. 5249–5259).</p><img src=\"https://medium.com/_/stat?event=post.clientViewed&referrerSource=full_rss&postId=94c75e18f4b8\" width=\"1\" height=\"1\" alt=\"\"><hr><p><a href=\"https://netflixtechblog.com/fm-intent-predicting-user-session-intent-with-hierarchical-multi-task-learning-94c75e18f4b8\">FM-Intent: Predicting User Session Intent with Hierarchical Multi-Task Learning</a> was originally published in <a href=\"https://netflixtechblog.com\">Netflix TechBlog</a> on Medium, where people are continuing the conversation by highlighting and responding to this story.</p>"
    }
  ],
  "lastUpdated": "2025-05-29T01:11:03.846Z"
}